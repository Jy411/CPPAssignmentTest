untested function
need to be put in the main file(?)